# Nginx configuration for browser caching of static assets

# Settings for SVG files (moved before general static files to take precedence)
location ~* \.svg$ {
    add_header Content-Security-Policy "default-src 'self'";
    expires 30d;
    add_header Cache-Control "public, no-transform";
    add_header Vary Accept;
    access_log off;
    etag on;
    try_files $uri =404;
}

# Enable cache for all static files (removed svg from this block)
# Only match files with specific extensions and ensure they exist as static files
location ~* \.(jpg|jpeg|png|gif|ico|webp|avif|css|js|eot|ttf|woff|woff2|otf)$ {
    # Only apply caching if the file actually exists as a static file
    try_files $uri =404;
    
    expires 30d;
    add_header Cache-Control "public, no-transform";
    add_header Vary Accept;
    access_log off;
    
    # Set ETag header for better cache validation
    etag on;
}

# Cache WordPress common files (minified JS/CSS, emoji JS) - be more specific
location ~* /wp-content/.*\.(min\.(css|js)|wp-emoji-release\.min\.js)$ {
    try_files $uri =404;
    expires 7d;
    add_header Cache-Control "public, no-transform";
}